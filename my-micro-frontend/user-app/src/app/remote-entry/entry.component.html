<div class="users-page">
    <!-- Removed Toast -->

    <!-- Add User Form -->
    <div class="form-section animate-fade-in">
        <div class="form-card card">
            <div class="card-header">
                <div>
                    <h3 class="card-title">{{ 'USER.TITLE' | translate }}</h3>
                    <p class="card-subtitle">{{ 'USER.FORM.FORM_SUBTITLE' | translate }}</p>
                </div>
                <p-button icon="pi pi-refresh" [rounded]="true" [text]="true" (click)="resetForm()"
                    severity="secondary"></p-button>
            </div>

            <div class="form-grid">
                <div class="form-field">
                    <p-floatlabel variant="on">
                        <input pInputText id="name" type="text" [(ngModel)]="newUser.name" class="w-full" />
                        <label for="name">{{ 'USER.FORM.NAME_LABEL' | translate }} *</label>
                    </p-floatlabel>
                </div>

                <div class="form-field">
                    <p-floatlabel variant="on">
                        <input pInputText id="email" type="email" [(ngModel)]="newUser.email" class="w-full" />
                        <label for="email">{{ 'USER.FORM.EMAIL_LABEL' | translate }} *</label>
                    </p-floatlabel>
                </div>

                <div class="form-field">
                    <p-floatlabel variant="on">
                        <p-select id="role" [options]="roles" [(ngModel)]="newUser.role" optionLabel="label"
                            optionValue="value" class="w-full" [fluid]="true"></p-select>
                        <label for="role">{{ 'USER.FORM.ROLE_LABEL' | translate }} *</label>
                    </p-floatlabel>
                </div>

                <div class="form-field">
                    <p-floatlabel variant="on">
                        <p-select id="department" [options]="departments" [(ngModel)]="newUser.department"
                            optionLabel="label" optionValue="value" class="w-full" [fluid]="true"></p-select>
                        <label for="department">{{ 'USER.FORM.DEPARTMENT_LABEL' | translate }} *</label>
                    </p-floatlabel>
                </div>
            </div>

            <div class="form-actions">
                <p-button [label]="'USER.FORM.CLEAR_BUTTON' | translate" icon="pi pi-times" severity="secondary"
                    (click)="resetForm()"></p-button>
                <p-button [label]="'USER.FORM.ADD_BUTTON' | translate" icon="pi pi-plus" severity="success"
                    (click)="addUser()"></p-button>
            </div>
        </div>
    </div>

    <!-- Users Table -->
    <div class="table-section animate-fade-in">
        <div class="table-card card">
            <div class="card-header">
                <div>
                    <h3 class="card-title">{{ 'USER.TABLE.TITLE' | translate }}</h3>
                    <p class="card-subtitle">{{ 'USER.TABLE.SUBTITLE' | translate:{count: users.length} }}</p>
                </div>
                <p-button [label]="'USER.TABLE.EXPORT_BUTTON' | translate" icon="pi pi-download" [outlined]="true"
                    severity="info"></p-button>
            </div>

            <p-table [value]="users" [tableStyle]="{ 'min-width': '50rem' }" styleClass="p-datatable-sm">
                <ng-template pTemplate="header">
                    <tr>
                        <th style="width: 5%">{{ 'USER.TABLE.COLUMNS.ID' | translate }}</th>
                        <th style="width: 20%">{{ 'USER.TABLE.COLUMNS.NAME' | translate }}</th>
                        <th style="width: 20%">{{ 'USER.TABLE.COLUMNS.EMAIL' | translate }}</th>
                        <th style="width: 10%">{{ 'USER.TABLE.COLUMNS.ROLE' | translate }}</th>
                        <th style="width: 15%">{{ 'USER.TABLE.COLUMNS.DEPARTMENT' | translate }}</th>
                        <th style="width: 10%">{{ 'USER.TABLE.COLUMNS.STATUS' | translate }}</th>
                        <th style="width: 10%">{{ 'USER.TABLE.COLUMNS.JOIN_DATE' | translate }}</th>
                        <th style="width: 10%">{{ 'USER.TABLE.COLUMNS.ACTIONS' | translate }}</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-user>
                    <tr>
                        <td><strong>#{{ user.id }}</strong></td>
                        <td>
                            <div class="user-cell">
                                <div class="user-avatar">{{ user.name.charAt(0) }}</div>
                                <span>{{ user.name }}</span>
                            </div>
                        </td>
                        <td>{{ user.email }}</td>
                        <td>
                            <span class="role-badge">{{ getRoleLabel(user.role) }}</span>
                        </td>
                        <td>{{ getDepartmentLabel(user.department) }}</td>
                        <td>
                            <span class="status-aktif" *ngIf="user.status === 'active'">{{ 'USER.TABLE.STATUS.ACTIVE' |
                                translate }}</span>
                            <span class="status-pasif" *ngIf="user.status !== 'active'">{{ 'USER.TABLE.STATUS.INACTIVE'
                                | translate }}</span>
                        </td>
                        <td>{{ user.joinDate }}</td>
                        <td>
                            <div class="action-buttons">
                                <p-button icon="pi pi-pencil" [text]="true" [rounded]="true" severity="info"></p-button>
                                <p-button icon="pi pi-trash" [text]="true" [rounded]="true" severity="danger"
                                    (onClick)="deleteUser(user)"></p-button>
                            </div>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="8" class="empty-message">
                            <div class="empty-state">
                                <i class="pi pi-users empty-icon"></i>
                                <p>{{ 'USER.TABLE.EMPTY_MESSAGE' | translate }}</p>
                            </div>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</div>